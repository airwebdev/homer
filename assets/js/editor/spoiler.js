(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t,r){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,l,a,c=[],i=!0,u=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=l.call(r)).done)&&(c.push(n.value),c.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{if(!i&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=wp.blockEditor.BlockControls,n=wp.components,o=n.ToolbarGroup,l=n.ToolbarDropdownMenu,a=wp.i18n.__;const c=function(e){var t=e.onToggle,n=e.isActive;return React.createElement("div",null,React.createElement(r,null,n&&React.createElement(o,null,React.createElement(l,{icon:homer.icons.more,label:a("Show More",homer.name),className:"typewriter-toolbar-btn active",controls:[{title:a("Show More: Remove",homer.name),icon:"trash",onClick:t}]}))))};var i=wp.blockEditor.URLPopover,u=wp.components.Button,m=homer.components.HomerColorPicker,s=wp.i18n.__;const p=function(e){var t=e.text,r=e.setText,n=e.color,o=e.setColor,l=e.underline,a=e.setUnderline,c=e.anchor,p=e.onToggle,h={color:n,"text-decoration":l?"underline":"none"};return React.createElement(i,{className:"homer-popover",anchor:c,placement:"bottom-start",headerTitle:s("Customize Show More",homer.name)},React.createElement("label",{className:"homer-popover-label pl pb"},s("Show more button settings",homer.name)),React.createElement("div",{className:"homer-popover-controls"},React.createElement("span",{className:"homer-popover-content",onBlur:function(e){return r(e.target.innerText)},contenteditable:"true",style:h},t),React.createElement(m,{color:n,onChange:function(e){return o(e||"#000")}}),React.createElement(u,{icon:"editor-underline",label:s("Add underline",homer.name),className:"true"===l?"homer-button active":"homer-button",onClick:function(){a("true"===l?"":"true")}}),React.createElement(u,{icon:"trash",className:"homer-button",label:s("Show more: Remove",homer.name),onClick:p})))};var h=wp.richText,d=h.toggleFormat,f=h.applyFormat,b=h.useAnchor,v=wp.element,g=v.Fragment,y=v.useState,w=v.useEffect,E=homer.name+"/spoiler",x=wp.i18n.__,R=wp.richText.registerFormatType;window.homer.components.spoiler=!0,R(homer.name+"/spoiler",{title:x("Hidden Text / Spoiler",homer.name),tagName:"span",className:"homer-spoiler",attributes:{text:"data-text",color:"data-color",underline:"data-underline",style:"style"},edit:function(e){var r=e.isActive,n=e.value,o=e.onChange,l=e.contentRef,a=e.activeAttributes,i=t(y(a.text?a.text:"show more..."),2),u=i[0],m=i[1],s=t(y(a.color?a.color:"#000"),2),h=s[0],v=s[1],x=t(y(a.underline?a.underline:"true"),2),R=x[0],T=x[1],C=b({editableContentElement:l.current,value:n,settings:{tagName:"span",className:"homer-spoiler",name:E}}),S=l.current&&parseFloat(getComputedStyle(l.current,null).getPropertyValue("font-size")||24);w((function(){r&&N()}),[u,h,R]),w((function(){r&&a.text&&m(a.text),r&&a.color&&v(a.color),r&&a.underline&&T(a.underline)}),[a]);var A=function(){o(d(n,{type:E}))},N=function(){o(f(n,{type:E,attributes:{text:u,color:h,underline:R,style:"--font-size: ".concat(S,"px; --color: ").concat(h)}}))};return React.createElement(g,null,React.createElement(c,{onToggle:A,isActive:r}),r&&React.createElement(p,{text:u,setText:m,color:h,setColor:v,underline:R,setUnderline:T,anchor:C,onToggle:A}))}})})();